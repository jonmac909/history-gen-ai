# Nixpacks configuration for Railway
# Install fontconfig and fonts for FFmpeg subtitle rendering

[phases.setup]
# fontconfig/fonts for FFmpeg, libvips for sharp, ffmpeg for video processing
aptPkgs = ["fontconfig", "fonts-dejavu-core", "fonts-liberation", "libvips-dev", "ffmpeg", "curl"]

[phases.install]
# Download yt-dlp binary directly to /usr/local/bin (more reliable than pip)
cmds = ["curl -L https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -o /usr/local/bin/yt-dlp && chmod a+rx /usr/local/bin/yt-dlp", "npm ci"]

[phases.build]
cmds = ["npm run build"]

[start]
cmd = "npm start"
